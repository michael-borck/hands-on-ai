<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ChatCraft Project Browser</title>
  <style>
    body { font-family: sans-serif; padding: 2em; background: #fdfdfd; }
    h1 { text-align: center; }
    .filters, .check-updates { margin-bottom: 1em; text-align: center; }
    .filters select { padding: 0.5em; font-size: 1em; }
    .project { border: 1px solid #ddd; border-radius: 8px; padding: 1em; margin: 1em 0; background: white; }
    .project h2 { margin-top: 0; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>📚 ChatCraft Mini Projects</h1>

  <div class="check-updates">
    <button onclick="checkVersion()">🔄 Check for Updates</button>
  </div>

  <div class="filters">
    <label for="tagFilter">Filter by tag:</label>
    <select id="tagFilter">
      <option value="all">All</option>
    </select>
  </div>

  <div id="projects"></div>

  <script>
    const CURRENT_VERSION = "1.0.0";

    function checkVersion() {
      fetch("https://raw.githubusercontent.com/YOUR_ORG/chatcraft/main/version.json")
        .then(res => res.json())
        .then(data => {
          if (data.version !== CURRENT_VERSION) {
            const updateMsg = `🚀 A newer version (${data.version}) is available!\n\n` +
                              `Visit: ${data.url}\n\n` +
                              `${data.notes || ''}`;
            alert(updateMsg);
          } else {
            alert("✅ You're using the latest version!");
          }
        })
        .catch(() => alert("⚠️ Unable to check for updates. Are you offline?"));
    }

    const projects = [
      {
        title: "Choose Your Own Adventure",
        summary: "Interactive storytelling where the bot responds based on choices.",
        tags: ["storytelling", "state management"],
        link: "./projects/choose-your-own-adventure.html"
      },
      {
        title: "Knowledge Quiz Bot",
        summary: "A bot that quizzes you on a subject using random questions.",
        tags: ["quiz", "revision"],
        link: "./projects/knowledge-quiz-bot.html"
      }
    ];

    const tagFilter = document.getElementById("tagFilter");
    const container = document.getElementById("projects");

    const allTags = new Set();
    projects.forEach(p => p.tags.forEach(t => allTags.add(t)));
    [...allTags].sort().forEach(tag => {
      const option = document.createElement("option");
      option.value = tag;
      option.textContent = tag;
      tagFilter.appendChild(option);
    });

    tagFilter.addEventListener("change", render);

    function render() {
      container.innerHTML = "";
      const filter = tagFilter.value;
      projects.forEach(project => {
        const matches = filter === "all" || project.tags.includes(filter);
        if (!matches) return;

        const div = document.createElement("div");
        div.className = "project";
        div.innerHTML = `
          <h2><a href="${project.link}">${project.title}</a></h2>
          <p>${project.summary}</p>
          <p><strong>Tags:</strong> ${project.tags.join(", ")}</p>
        `;
        container.appendChild(div);
      });
    }

    render();
  </script>
</body>
</html>
